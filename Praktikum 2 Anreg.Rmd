---
title: "Praktikum 2 Anreg"
author: "Keira Gisella"
date: "`r Sys.Date()`"
output: 
  rmdformats::readthedown:
    css: cat-theme.css
---

# Data

## Membaca Data

```{r}
library(readxl)

data <- read_excel("C:\\Users\\Keira Gisella\\Downloads\\NSC-2025.xlsx", sheet="Sheet2")
head(data) #menampilkan sebagian data awal
```

## Menyesuaikan Peubah

```{r}
colnames(data) <- c("Kabupaten/Kota", "Y", paste0("X", 1:9))
head(data)
```

# Eksplorasi Data

Menentukan banyaknya baris data (n).

```{r}
n <- nrow(data)
```

Membuat scatter plot untuk variabel Y (Indeks Pembangunan Manusia) dan variabel X4 (Persentase Akses Sanitasi Layak).

```{r}
plot(data$X4, data$Y,
     main = "Persentase Akses Sanitasi Layak (PASL) vs Indeks Pembangunan Manusia (IPM)",
     xlab = "PASL(%)",
     ylab = "IPM")
```

```{r}
summary(data$Y)
```

```{r}
boxplot(data$Y)
```

```{r}
summary(data$X4)
```

```{r}
boxplot(data$X4)
```

# Pembentukan Model

## Manual

### Koefisien Regresi

$\hat{y_i} = \hat{\beta_0} + \hat{\beta_1} x_{i}, i = 1,2, ..., n$ $\hat{\beta_1} = \frac{\sum(y_i - \bar{y}) - \sum(x_i - \bar{x})}{\sum(x_i - \bar{x})^2} = \frac{S_{xx}{S_{xy} atau$ $\hat{\beta_1} = \frac{\sum (x_iy)-\frac{\sum(x_i)\sum(y)}{n}}{\sum(x_i^2)-\frac{\sum(x_i^2)}{n}}$ $\hat{\beta_0} = \bar{y} - \hat{\beta_1} \bar{x}$

```{r}
x <- data$X4
y <- data$Y
```

```{r}
b1 <- (sum(x*y)-sum(x)*sum(y)/n)/(sum(x^2)-(sum(x)^2/n))
b0 <- mean(y)-b1*mean(x)

cat("Koefisien b0:", b0, "\n")  
cat("Koefisien b1:", b1, "\n")
```

### Standar Error Parameter Regresi

```{r}
galat <- y-(b0+b1*x)
ragam_galat <- sum(galat^2)/(n-2)

se_b0 <- sqrt(ragam_galat*(1/n+mean(x)^2/sum((x-mean(x))^2)))
se_b1 <- sqrt(ragam_galat/sum((x-mean(x))^2))

cat("Standar error b0:", se_b0, "\n") 
cat("Standar error b1:", se_b1, "\n")
```

### Signifikansi Parameter (nilai-t)

```{r}
t_b0 <- b0/se_b0
t_b1 <- b1/se_b1
p_b0 <- 2*pt(-abs(t_b0 ),df<-n-2)
p_b1 <- 2*pt(-abs(t_b1 ),df<-n-2)

cat("Nilai t pada b0 adalah", t_b0, "dengan nilai p sebesar", p_b0, "\n")  
```

```{r}
cat("Nilai t pada b1 adalah", t_b1, "dengan nilai p sebesar", p_b1, "\n") 
```

Nilai p kurang dari alpha 0.05 untuk b0 maupun b1 sehingga signifikan pada taraf nyata 5%

### Koefisien Determinasi dan Penyesuaiannya

```{r}
r <- (sum(x*y)-sum(x)*sum(y)/n)/
sqrt((sum(x^2)-(sum(x)^2/n))*(sum(y^2)-(sum(y)^2/n)))
Koef_det <- r^2
Koef_det
```

```{r}
Adj_R2 <- 1-((1-Koef_det)*(n-1)/(n-1-1))
Adj_R2
```

### Signifikansi Simultan (F)

```{r}
galat<-y-(b0+b1*x)

JKG <- sum((y - (b0+b1*x))^2)
JKReg <- sum(((b0+b1*x)- mean(y))^2)
JKT <- sum((y - mean(y))^2)
JKT <- JKReg+JKG

dbReg <- 1
dbg <- n-2
dbt <- n-1

(Fhit <- (JKReg/dbReg)/(JKG/dbg))
```

```{r}
(p_Fhit <- pf(Fhit, dbReg, dbg, lower.tail = F))
```

Nilai p kurang dari alpha 0.05 sehingga secara simultan X dan Y saling memengaruhi

## Menggunakan Fungsi `lm()`

```{r}
model <- lm(Y~X4, data = data)
summary(model)
```

Berdasarkan hasil diperoleh bahwa kedua cara valid dan memberikan hasil yang sama dalam membuat pemodelan regresi linear sederhana.

```{r}
anova(model)
```

# Kesimpulan

Model yang terbentuk adalah sebagai berikut:

$$\hat{Y} = 60.25436 + 0.1828026 X_4$$

dengan Y adalah Indeks Pembangunan Manusia (IPM) dan X4 adalah persentase akses sanitasi layak.

Didapatkan nilai $\hat\beta_0 = 60.25436$ artinya nilai dugaan rataan indeks pembangunan manusia ketika persentase akses sanitasi layak bernilai 0% adalah 60.25436, akan tetapi karena nilai 0% tidak berada dalam selang pengamatan persentase akses sanitasi layak sehingga $\hat\beta_0$ tidak dapat didefinisikan lebih lanjut.

Nilai $\hat\beta_1 = 0.1828026$ menunjukkan setiap kenaikan 1% persentase akses sanitasi layak akan meningkatkan nilai dugaan rataan indeks pembangunan manusia sebesar 0.183 poin.

Koefisien determinasi yang dihasilkan adalah 0.239335 artinya keragaman indeks pembangunan manusia dapat dijelaskan oleh persentase akses sanitasi layak adalah sebesar 23.93%, sisanya yaitu 76.07% dijelaskan oleh peubah lain yang tidak dimasukkan dalam model.
